!function(t,n,e,a){"use strict";function i(){n.body.removeChild(this);var t=p(this.getAttribute("data-backdrop-for"));c.splice(t.index,1),this.off(e.event.transitionEnd,i,!1)}function o(e){if(!e.classList.contains("active")){e.style.display="block",t.setTimeout(function(){e.classList.add("active")},10);var a=l(e.getAttribute("id"));n.body.appendChild(a),c.push({panel:e,backdrop:a})}}function r(t){if(t.classList.contains("active")){t.classList.remove("active"),t.classList.add("panel-closing");var n=function(){t.classList.remove("panel-closing"),t.style.display="none",t.off(e.event.transitionEnd,n)};t.on(e.event.transitionEnd,n);var a=p(t.getAttribute("id"));a&&(a.backdrop.classList.add("fadeout"),a.backdrop.on(e.event.transitionEnd,i,!1))}}function s(){var t=c.length>0;return t&&r(c[c.length-1].panel),t}var c=[],l=function(t){var e=n.createElement("div");return e.classList.add("backdrop-panel"),e.setAttribute("data-backdrop-for",t),e},d=function(t){for(var e,a=n.querySelectorAll("[data-panel-id], [data-panel-close]");t&&t!==n;t=t.parentNode)for(e=a.length;e--;)if(a[e]===t)return t},f=function(t){var e=d(t.target);if(e){var a=e.getAttribute("data-panel-id");return a?n.querySelector("#"+a):u(t.target)}},p=function(t){for(var n=c.length,e=0;e<n;e++)if(c[e].panel.getAttribute("id")===t){var a=c[e];return a.index=e,a}return null},u=function(t){for(var e,a=n.querySelectorAll(".panel, .panel-full");t&&t!==n;t=t.parentNode)for(e=a.length;e--;)if(a[e]===t&&t.classList.contains("active"))return t},v=function(t){for(;t&&t!==n;t=t.parentNode)if(t.classList.contains("dialog")||t.classList.contains("backdrop-dialog")||t.classList.contains("popover")||t.classList.contains("backdrop-popover"))return!0;return!1};n.on(e.event.start,function(t){if(t=t.originalEvent||t,!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification"))&&!v(t.target)&&c.length>0){var n=c[c.length-1].panel,e=u(t.target);e||r(n),e&&e!==n&&e.id!==n.id&&r(n)}}),n.on(e.event.tap,function(t){if(!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification")||v(t.target))){var n=d(t.target),e=null;if(n&&(e=f(t),e&&(e.classList.contains("active")?r(e):o(e))),e=u(t.target),!e&&!n&&c.length>0){var a=c[c.length-1].panel;u(t.target);r(a)}}}),e.panel=function(t){var e="string"==typeof t?n.querySelector(t):t;if(null===e)throw new Error("The panel with ID "+t+" does not exist");return{open:function(){o(e)},close:function(){r(e)}}},e.panelUtil={closeActive:s},t.phonon=e,"object"==typeof exports?module.exports=e.panel:"function"==typeof define&&define.amd&&define(function(){return e.panel})}(window,document,window.phonon||{});